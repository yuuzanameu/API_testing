meta {
  name: create new environment
  type: http
  seq: 1
}

post {
  url: {{URL}}/api/v1/api-testing/create-environment?scope=environment
  body: json
  auth: bearer
}

params:query {
  scope: environment
}

auth:bearer {
  token: {{token}}
}

body:json {
  {
      "name": "Productiolop"
      ///scope: global
  }
  
}

settings {
  encodeUrl: true
}

example {
  name: with some keys
  
  request: {
    url: {{URL}}/api/v1/api-testing/create-environment
    method: POST
    mode: json
    body:json: {
      {
          "name": "Staging",
          "variables": [
            {
              "key": "URL",
              "value": "https://qa-automator-staging.letest.ai"
            }
          ]
      }
      
    }
  }
  
  response: {
    headers: {
      Content-Security-Policy: default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests
      Cross-Origin-Opener-Policy: same-origin
      Cross-Origin-Resource-Policy: same-origin
      Origin-Agent-Cluster: ?1
      Referrer-Policy: no-referrer
      Strict-Transport-Security: max-age=31536000; includeSubDomains
      X-Content-Type-Options: nosniff
      X-DNS-Prefetch-Control: off
      X-Download-Options: noopen
      X-Frame-Options: SAMEORIGIN
      X-Permitted-Cross-Domain-Policies: none
      X-XSS-Protection: 0
      Access-Control-Allow-Origin: *
      Content-Type: application/json; charset=utf-8
      Content-Length: 162
      ETag: W/"a2-XYyUEawvtciL7R08PPa8Lm6cjp8"
      Date: Wed, 29 Oct 2025 05:51:39 GMT
      Connection: keep-alive
      Keep-Alive: timeout=5
    }
  
    status: {
      code: Created
      text: 201
    }
  
    body: {
      type: json
      content: '''
        {
            "success": true,
            "message": "api_environment_created",
            "data": {
                "id": 2,
                "name": "Staging",
                "variables": [
                    {
                        "key": "URL",
                        "value": "https://qa-automator-staging.letest.ai"
                    }
                ]
            }
        }
      '''
    }
  }
}

example {
  name: empty environment
  
  request: {
    url: {{URL}}/api/v1/api-testing/create-environment
    method: POST
    mode: json
    body:json: {
      {
          "name": "Local"
      }
      
    }
  }
  
  response: {
    headers: {
      Content-Security-Policy: default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests
      Cross-Origin-Opener-Policy: same-origin
      Cross-Origin-Resource-Policy: same-origin
      Origin-Agent-Cluster: ?1
      Referrer-Policy: no-referrer
      Strict-Transport-Security: max-age=31536000; includeSubDomains
      X-Content-Type-Options: nosniff
      X-DNS-Prefetch-Control: off
      X-Download-Options: noopen
      X-Frame-Options: SAMEORIGIN
      X-Permitted-Cross-Domain-Policies: none
      X-XSS-Protection: 0
      Access-Control-Allow-Origin: *
      Content-Type: application/json; charset=utf-8
      Content-Length: 98
      ETag: W/"62-7L3xWxcAKs4FYiZCfJs/xWKvn74"
      Date: Wed, 29 Oct 2025 06:25:06 GMT
      Connection: keep-alive
      Keep-Alive: timeout=5
    }
  
    status: {
      code: Created
      text: 201
    }
  
    body: {
      type: json
      content: '''
        {
            "success": true,
            "message": "api_environment_created",
            "data": {
                "id": 3,
                "name": "Local",
                "variables": []
            }
        }
      '''
    }
  }
}

example {
  name: default scope environment
  
  request: {
    url: {{URL}}/api/v1/api-testing/create-environment?scope=environment
    method: POST
    mode: json
    params:query: {
      scope: environment
    }
  
    body:json: {
      {
          "name": "Production"
      }
      
    }
  }
  
  response: {
    headers: {
      Content-Security-Policy: default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests
      Cross-Origin-Opener-Policy: same-origin
      Cross-Origin-Resource-Policy: same-origin
      Origin-Agent-Cluster: ?1
      Referrer-Policy: no-referrer
      Strict-Transport-Security: max-age=31536000; includeSubDomains
      X-Content-Type-Options: nosniff
      X-DNS-Prefetch-Control: off
      X-Download-Options: noopen
      X-Frame-Options: SAMEORIGIN
      X-Permitted-Cross-Domain-Policies: none
      X-XSS-Protection: 0
      Access-Control-Allow-Origin: *
      Content-Type: application/json; charset=utf-8
      Content-Length: 103
      ETag: W/"67-Q+hRwfY72Xlcs07vvZ86BLFz+Ao"
      Date: Wed, 29 Oct 2025 06:25:43 GMT
      Connection: keep-alive
      Keep-Alive: timeout=5
    }
  
    status: {
      code: Created
      text: 201
    }
  
    body: {
      type: json
      content: '''
        {
            "success": true,
            "message": "api_environment_created",
            "data": {
                "id": 4,
                "name": "Production",
                "variables": []
            }
        }
      '''
    }
  }
}
